# ---------------------------------------
# PSO for Data Clustering
# ---------------------------------------
# Step 1: Import Libraries
import numpy as np
import pandas as pd
from sklearn.preprocessing import MinMaxScaler
from sklearn.metrics import pairwise_distances_argmin
import pyswarms as ps

# Step 2: Load Dataset
data = pd.read_csv("/content/SCOA_A7.csv")
X = data[['Age', 'Annual Income (k$)', 'Spending Score (1-100)']].values

# Step 3: Normalize Data
scaler = MinMaxScaler()
X = scaler.fit_transform(X)

# Step 4: Define Clustering Function
def cluster_cost(centroids_flat):
    n_clusters = 3
    centroids = centroids_flat.reshape(n_clusters, X.shape[1])
    labels = pairwise_distances_argmin(X, centroids)
    # Sum of squared distances (SSE)
    cost = sum(np.sum((X[labels == i] - centroids[i])**2) for i in range(n_clusters))
    return cost

# Wrap for all particles
def cost_wrapper(particles):
    return np.array([cluster_cost(p) for p in particles])

# Step 5: Run PSO Optimization

n_clusters = 3
dims = n_clusters * X.shape[1]
options = {'c1': 1.5, 'c2': 1.5, 'w': 0.5}

optimizer = ps.single.GlobalBestPSO(n_particles=20, dimensions=dims, options=options)
best_cost, best_pos = optimizer.optimize(cost_wrapper, iters=50)

# Step 6: Final Clusters
best_centroids = best_pos.reshape(n_clusters, X.shape[1])
labels = pairwise_distances_argmin(X, best_centroids)

# Step 7: Display Results
print("Best Centroids:\n", best_centroids)
print("Best Cost (SSE):", best_cost)
print("Cluster labels sample:", labels[:10])


import matplotlib.pyplot as plt

plt.scatter(X[:,0], X[:,1], c=labels, cmap='rainbow')
plt.scatter(best_centroids[:,0], best_centroids[:,1], color='black', marker='o', s=200)
plt.title("PSO Clustering Result")
plt.show()


# ---------------------------------------------
# Assignment 5: ANN for Stock Market Trend Prediction
# ---------------------------------------------
# Aim: Predict next-day stock trend (Up/Down) using ANN
# Dataset: date, open, high, low, close, volume, name
# ---------------------------------------------

import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import MinMaxScaler
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense

# ---------------------------------------------
# Step 1: Load and Prepare Data
# ---------------------------------------------
data = pd.read_csv("/content/SCOA_A5.csv")     # replace with your dataset name

# Create simple features
data['PriceDiff'] = data['close'] - data['open']
data['Range'] = data['high'] - data['low']

# Target: 1 if next day close > today close else 0
data['Target'] = (data['close'].shift(-1) > data['close']).astype(int)
data = data.dropna()

# Features and labels
X = data[['open', 'high', 'low', 'close', 'volume', 'PriceDiff', 'Range']]
y = data['Target']

# Scale features for ANN
scaler = MinMaxScaler()
X_scaled = scaler.fit_transform(X)

# Split data
X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.2, random_state=42)

# ---------------------------------------------
# Step 2: Build Simple ANN Model
# ---------------------------------------------
model = Sequential([
    Dense(10, input_dim=X_train.shape[1], activation='relu'),
    Dense(8, activation='relu'),
    Dense(1, activation='sigmoid')
])

# ---------------------------------------------
# Step 3: Compile and Train Model
# ---------------------------------------------
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])
model.fit(X_train, y_train, epochs=20, batch_size=32, verbose=1)

# ---------------------------------------------
# Step 4: Evaluate Model
# ---------------------------------------------
loss, acc = model.evaluate(X_test, y_test, verbose=0)
print(f"Model Accuracy: {acc*100:.2f}%")

# ---------------------------------------------
# Step 5: Predict Trend for Last Record
# ---------------------------------------------
last = np.array(X_scaled[-1:])     # last day‚Äôs features
pred = model.predict(last)
trend = "UP" if pred > 0.5 else "DOWN"
print(f"Predicted Next-Day Trend: {trend}")






üß† Theory
üìç What is ANN (Artificial Neural Network)?
	ANN is a model inspired by how the human brain works.
	It learns patterns from data and makes predictions.
	Each neuron performs:
y=f(w_1 x_1+w_2 x_2+...+b)

where
	x_i‚Üí input features
	w_i‚Üí weights (learned by training)
	b‚Üí bias
	f()‚Üí activation function (like ReLU, Sigmoid)
________________________________________
‚öôÔ∏è How ANN learns
	Forward Propagation ‚Äì compute predicted output using weights
y ÃÇ=f(WX+b)

	Loss Function ‚Äì measure error between predicted and actual
For binary output (Up/Down):
L=-[ylog‚Å°(y ÃÇ)+(1-y)log‚Å°(1-y ÃÇ)]

	Backward Propagation ‚Äì adjust weights to minimize loss using gradient descent.
Optimizer like Adam automates this.
________________________________________
üéØ Our Problem: Stock Market Trend
We want to predict:
Will tomorrow‚Äôs stock go UP or DOWN?
Input features:
	open, high, low, close, volume
	derived features: PriceDiff = close ‚àí open, Range = high ‚àí low
Target:
"Target"={‚ñ†(1&"if next day‚Äôs close > today‚Äôs close" @0&"otherwise" )

________________________________________
üß© Step-by-Step Code Explanation
Step 1: Import Libraries
import pandas as pd, numpy as np
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import MinMaxScaler
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense
‚úÖ Loads all necessary tools for data handling, scaling, splitting, and building the ANN.
________________________________________
Step 2: Load & Prepare Data
data = pd.read_csv("/content/SCOA_A5.csv")
Reads dataset (must have columns: date, open, high, low, close, volume).
Feature engineering:
data['PriceDiff'] = data['close'] - data['open']
data['Range'] = data['high'] - data['low']
Create target column:
data['Target'] = (data['close'].shift(-1) > data['close']).astype(int)
	shift(-1) compares today‚Äôs close with tomorrow‚Äôs close.
	Gives 1 (UP) or 0 (DOWN).
	.astype(int) converts True/False ‚Üí 1/0.
Drop last NaN row (since next-day value doesn‚Äôt exist):
data = data.dropna()
________________________________________
Step 3: Prepare X and y
X = data[['open', 'high', 'low', 'close', 'volume', 'PriceDiff', 'Range']]
y = data['Target']
‚úÖ X ‚Üí input features, y ‚Üí output label
Normalize inputs
scaler = MinMaxScaler()
X_scaled = scaler.fit_transform(X)
	Scales all features between 0 and 1.
	Helps faster and stable ANN training.
Split dataset
X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.2, random_state=42)
	80% data ‚Üí training
	20% data ‚Üí testing
________________________________________
Step 4: Build ANN
model = Sequential([
    Dense(10, input_dim=X_train.shape[1], activation='relu'),
    Dense(8, activation='relu'),
    Dense(1, activation='sigmoid')
])
Layer-wise explanation:
Layer	Type	Neurons	Activation	Purpose
1	Dense	10	ReLU	learns non-linear patterns
2	Dense	8	ReLU	deeper pattern learning
3	Dense	1	Sigmoid	output 0‚Äì1 (Up/Down)
________________________________________
Step 5: Compile & Train
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])
model.fit(X_train, y_train, epochs=20, batch_size=32, verbose=1)
‚úÖ Binary Crossentropy used since target = 0/1
‚úÖ Adam optimizer updates weights automatically
‚úÖ Trains for 20 iterations (epochs)
________________________________________
Step 6: Evaluate Model
loss, acc = model.evaluate(X_test, y_test, verbose=0)
print(f"Model Accuracy: {acc*100:.2f}%")
Shows how well ANN predicts Up/Down on unseen data.
________________________________________
Step 7: Predict Next Day‚Äôs Trend
last = np.array(X_scaled[-1:])
pred = model.predict(last)
trend = "UP" if pred > 0.5 else "DOWN"
print(f"Predicted Next-Day Trend: {trend}")
	Takes the last record
	Predicts next-day trend
	If output > 0.5 ‚Üí UP else DOWN
________________________________________
üî¢ Formulas Recap
	Input to neuron:
z=‚àëw_i x_i+b

	Activation (ReLU):
f(z)=max‚Å°(0,z)

	Output (Sigmoid):
œÉ(z)=1/(1+e^(-z) )

	Loss (Binary Cross Entropy):
L=-[ylog‚Å°(y ÃÇ)+(1-y)log‚Å°(1-y ÃÇ)]

________________________________________
üß≠ Summary for Viva / Notes
Concept	Explanation
Aim	Predict next day‚Äôs stock trend using ANN
Input Features	open, high, low, close, volume, PriceDiff, Range
Output	1 (UP), 0 (DOWN)
Model Type	Feedforward ANN
Activation	ReLU (hidden), Sigmoid (output)
Loss Function	Binary Crossentropy
Optimizer	Adam
Evaluation Metric	Accuracy
Output Example	Model Accuracy = 88.25%, Predicted Trend: UP

